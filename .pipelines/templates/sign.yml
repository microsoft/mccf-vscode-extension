steps:
- task: EsrpCodeSigning@4
  inputs:
    ConnectedServiceName: 'MCCF VSCode'
    FolderPath: '$(Build.SourcesDirectory)/out'
    Pattern: '*.js'
    signConfigType: 'inlineSignParams'
    inlineOperation: |
      [
       {
        "KeyCode": "CP-230012",
        "OperationCode": "SigntoolSign",
        "ToolName": "sign",
        "ToolVersion": "1.0",
        "Parameters": {
         "OpusName": "Microsoft",
         "OpusInfo": "https://www.microsoft.com",
         "FileDigest": "/fd SHA256",
         "PageHash": "/NPH",
         "TimeStamp": "/tr \"http://rfc3161.gtm.corp.microsoft.com/TSS/HttpTspServer\" /td sha256"
        }
       },
       {
        "KeyCode": "CP-230012",
        "OperationCode": "SigntoolVerify",
        "ToolName": "sign",
        "ToolVersion": "1.0",
        "Parameters": {}
       }
      ]
    SessionTimeout: '60'
    MaxConcurrency: '50'
    MaxRetryAttempts: '5'
    PendingAnalysisWaitTimeoutMinutes: '5'